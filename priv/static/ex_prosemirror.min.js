var LiveView=(()=>{var _=Object.defineProperty,pe=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable;var z=(t,e,r)=>e in t?_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,i=(t,e)=>{for(var r in e||(e={}))ue.call(e,r)&&z(t,r,e[r]);if(B)for(var r of B(e))fe.call(e,r)&&z(t,r,e[r]);return t},l=(t,e)=>pe(t,de(e)),he=t=>_(t,"__esModule",{value:!0});var R=(t,e)=>{he(t);for(var r in e)_(t,r,{get:e[r],enumerable:!0})};var Ae={};R(Ae,{ExEditorView:()=>h,ExProsemirrorHooks:()=>J,baseKeymap:()=>se,blocks:()=>oe,createSchema:()=>p,default:()=>O,generateSchemaMarks:()=>v,generateSchemablocks:()=>P,hardBreakKeymap:()=>le,icons:()=>w,inject:()=>a,insertPlaceholder:()=>I,keymap:()=>ie,marks:()=>te,menu:()=>y,placeholderPlugin:()=>g,replacePlaceholder:()=>D});function a(t,e){let r=window.__EX_PROSEMIRROR_INJECT__||{};e&&(r[t]=e);let o=r[t];if(o)return o;throw new Error(`Unable to find ${t} in browser environment`)}var{Plugin:ge}=a("prosemirror-state"),{Decoration:Me,DecorationSet:ke}=a("prosemirror-view"),g=new ge({state:{init(){return ke.empty},apply(t,e){e=e.map(t.mapping,t.doc);let r=t.getMeta(this);if(r&&r.add){let o=document.createElement("placeholder"),n=Me.widget(r.add.pos,o,{id:r.add.id});e=e.add(t.doc,[n])}else r&&r.remove&&(e=e.remove(e.find(null,null,o=>o.id==r.remove.id)));return e}},props:{decorations(t){return this.getState(t)}}});function I(t,{nodeType:e}){let r={},o=t.editorView.state.tr;o.selection.empty||o.deleteSelection(),t.editorNode.addEventListener("replacePlaceholder",function(s){D(t,s)}),o.setMeta(g,{add:{id:r,pos:o.selection.from}}),t.editorView.dispatch(o);let n={detail:{nodeType:e,id:r,tr:o}};t.editorNode.dispatchEvent(new CustomEvent("insertPlaceholder",n))}function D(t,{detail:e}){let r=be(t.editorView.state,e.id);r!=null&&xe({node:e.callback(t.editorView.state.schema.nodes),id:e.id,pos:r,exEditorView:t})}function xe({exEditorView:t,id:e,pos:r,node:o}){t.editorView.dispatch(t.editorView.state.tr.replaceWith(r,r,o).setMeta(g,{remove:{id:e}}))}function be(t,e){let o=g.getState(t).find(null,null,n=>n.id==e);return o.length?o[0].from:null}var y={};R(y,{cmdItem:()=>V,generateColorsMenu:()=>A,generateFontFamilyMenu:()=>F,generateHTMLItem:()=>Q,generateHeadingItem:()=>X,generateMarkItem:()=>d,generateMediaMenu:()=>Y,generateMultiMarkItem:()=>L,generateParagraphItem:()=>G,markActive:()=>ee,markItem:()=>Z,menuHelper:()=>u,multiMarkItem:()=>E});var{icons:Se}=a("prosemirror-menu"),w=l(i({},Se),{strikethrough:{width:22,height:22,path:"M15.6 8.5c-.5-.7-1-1.1-1.3-1.3c-.6-.4-1.3-.6-2-.6c-2.7 0-2.8 1.7-2.8 2.1c0 1.6 1.8 2 3.2 2.3c4.4.9 4.6 2.8 4.6 3.9c0 1.4-.7 4.1-5 4.1A6.2 6.2 0 017 16.4l1.5-1.1c.4.6 1.6 2 3.7 2c1.6 0 2.5-.4 3-1.2c.4-.8.3-2-.8-2.6c-.7-.4-1.6-.7-2.9-1c-1-.2-3.9-.8-3.9-3.6C7.6 6 10.3 5 12.4 5c2.9 0 4.2 1.6 4.7 2.4l-1.5 1.1zM5 11h14a1 1 0 010 2H5a1 1 0 010-2z"},underline:{width:22,height:20,path:"M16 5c.6 0 1 .4 1 1v5.5a4 4 0 01-.4 1.8l-1 1.4a5.3 5.3 0 01-5.5 1a5 5 0 01-1.6-1c-.5-.4-.8-.9-1.1-1.4a4 4 0 01-.4-1.8V6c0-.6.4-1 1-1s1 .4 1 1v5.5c0 .3 0 .6.2 1l.6.7a3.3 3.3 0 002.2.8a3.4 3.4 0 002.2-.8c.3-.2.4-.5.6-.8l.2-.9V6c0-.6.4-1 1-1zM8 17h8c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 010-2z"}});function K(t,e){return function(r,o){let{empty:n,$cursor:s,ranges:c}=r.selection;if(n&&!s)return!1;if(o)if(s)t.isInSet(r.storedMarks||s.marks())&&o(r.tr.removeStoredMark(t)),e&&o(r.tr.addStoredMark(t.create(e)));else{let M=!1,j=r.tr;for(let m=0;!M&&m<c.length;m++){let{$from:k,$to:x}=c[m];M=r.doc.rangeHasMark(k.pos,x.pos,t)}for(let m=0;m<c.length;m++){let{$from:k,$to:x}=c[m],b=k.pos,S=x.pos,N=k.nodeAfter,H=x.nodeBefore,T=N&&N.isText?/^\s*/.exec(N.text)[0].length:0,me=H&&H.isText?/\s*$/.exec(H.text)[0].length:0;b+T<S&&(b+=T,S-=me),e?j.addMark(b,S,t.create(e)):j.removeMark(b,S,t)}o(j.scrollIntoView())}return!0}}var q=(t,e)=>{let r={};return t.map(o=>{e[o.type]&&(r[o.type]=l(i({},e[o.type]),{config:o}))}),r};var{MenuItem:C,blockTypeItem:W,Dropdown:U}=a("prosemirror-menu"),{toggleMark:Ie}=a("prosemirror-commands");function we({name:t,spec:{title:e}}){return e||t}var X=t=>t.nodes.heading?t.nodes.heading.spec.config.values.map(e=>W(t.nodes.heading,{title:"Header "+e,label:"Header "+e,attrs:{level:e}})):[],G=t=>t.nodes.paragraph?[W(t.nodes.paragraph,{title:"paragraph",label:"paragraph"})]:[],Q=t=>t.nodes.html?[new C({title:"Insert HTML code",label:"HTML",enable(){return!0},run(e,r,o){o.dom.parentNode.parentNode.dispatchEvent(new CustomEvent("exProsemirrorInsertPlaceholder",{detail:{nodeType:"html"}}))}})]:[],Y=t=>t.nodes.image?[new C({title:"Insert image",label:"Image",enable(){return!0},run(e,r,o){o.dom.parentNode.parentNode.dispatchEvent(new CustomEvent("exProsemirrorInsertPlaceholder",{detail:{nodeType:"image"}}))}})]:[],d=t=>e=>{if(!e.marks[t])return[];let r=e.marks[t],o=r.spec.icon||w[t];return[Z(e.marks[t],{title:we(r),icon:o})]};function Z(t,e){let r={active(o){return ee(o,t)},enable:!0};for(let o in e)r[o]=e[o];return V(Ie(t),r)}function V(t,e){let r={label:e.title,run:t};for(let o in e)r[o]=e[o];return(!e.enable||e.enable===!0)&&!e.select&&(r[e.enable?"enable":"select"]=o=>t(o)),new C(r)}function ee(t,e){let{from:r,$from:o,to:n,empty:s}=t.selection;return s?e.isInSet(t.storedMarks||o.marks()):t.doc.rangeHasMark(r,n,e)}var A=t=>{let e=L(t,"color");return[new U(e,{label:"Color"})]},F=t=>{let e=L(t,"font_family");return[new U(e,{label:"Font"})]},L=(t,e)=>{if(!t.marks[e])return[];let r=[E(t.marks[e],{title:"default"})],o=t.marks[e].spec.config.values;if(Array.isArray(o))for(let n of o){let s=[];s[e]=n,r.push(E(t.marks[e],{title:n},s))}else for(let[n,s]of Object.entries(o)){let c=[];c[e]=s,r.push(E(t.marks[e],{title:n},c))}return r};function E(t,e,r){return V(K(t,r),i({enable:!0},e))}var u={generateParagraphItem:G,generateHeadingItem:X,generateHTMLItem:Q,generateMediaMenu:Y};var{marks:$}=a("prosemirror-schema-basic"),te={strong:l(i({},$.strong),{generateMenuItem:d("strong")}),em:l(i({},$.em),{generateMenuItem:d("em")}),link:i({},$.link),strikethrough:{toDOM(){return["del",0]},parseDOM:[{tag:"del"}],generateMenuItem:d("strikethrough")},underline:{toDOM(){return["span",{style:"text-decoration: underline"},0]},parseDOM:[{tag:"span"}],generateMenuItem:d("underline")},color:{title:"Color",label:"Color",attrs:{color:{}},toDOM(t){return["span",{style:"color: "+t.attrs.color},0]},parseDOM:[{tag:"span",getAttrs(t){return{color:t.style.color}}}],generateMenuItem:A},font_family:{title:"Font",label:"Font",attrs:{font_family:{}},toDOM(t){return["span",{style:"font-family: "+t.attrs.font_family},0]},parseDOM:[{tag:"span",getAttrs(t){return{font_family:t.style["font-family"]}}}],generateMenuItem:F}},v=({marksSelection:t,marks:e})=>q(t,e);function Ee(t,e){return e?{content:"block?"}:t.doc}var re=(t,e,r)=>{let o={text:e.text,doc:Ee(e,r)};return t.map(n=>{e[n.type]&&(o[n.type]=l(i({},e[n.type]),{config:n}))}),o};var{nodes:f}=a("prosemirror-schema-basic"),ye=l(i({},f.paragraph),{generateMenuItem:u.generateParagraphItem}),ve=l(i({},f.heading),{generateMenuItem:u.generateHeadingItem}),Pe={inline:!0,attrs:{html:{default:null}},group:"inline",draggable:!1,parseDOM:[{tag:"div[html]",getAttrs(t){return{html:t.getAttribute("html")}}}],toDOM(t){let{html:e}=t.attrs,r=document.createElement("div");return r.innerHTML=e,r},generateMenuItem:u.generateHTMLItem},Oe=l(i({},f.image),{inline:!1,group:"block",generateMenuItem:u.generateMediaMenu}),oe={doc:f.doc,text:f.text,hard_break:f.hard_break,paragraph:ye,heading:ve,image:Oe,html:Pe},P=({blocksSelection:t,blocks:e,inline:r})=>re(t,e,r);var{Schema:je}=a("prosemirror-model"),p=t=>new je({nodes:P(t),marks:v(t)});var{DOMParser:ne}=a("prosemirror-model"),{EditorState:Ne}=a("prosemirror-state"),{EditorView:He}=a("prosemirror-view"),h=class{constructor(e,r){this.editorNode=e,this.target=e.dataset.target+"_plain",this.editorView=new He(e,{state:this.initializeEditorState(r),dispatchTransaction:o=>{this.dispatchTransaction(o)}}),this.addListeners()}initializeEditorState({blocks:e,marks:r,plugins:o}){let n={marksSelection:JSON.parse(this.editorNode.dataset.marks),blocksSelection:JSON.parse(this.editorNode.dataset.blocks),inline:JSON.parse(this.editorNode.dataset.inline),blocks:e,marks:r},s=p(n);return o=o(s).map((c,M)=>(c.key.startsWith("plugin$")&&(c.key="plugin$"+M),c)),Ne.create({doc:this.getDoc(s),plugins:o})}getDoc(e){let r=document.querySelector(this.target).value;if(r.length>0)try{return e.nodeFromJSON(JSON.parse(r))}catch(o){return ne.fromSchema(e).parse("")}else return ne.fromSchema(e).parse("")}addListeners(){let e=this;this.editorNode.addEventListener("exProsemirrorInsertPlaceholder",({detail:r})=>{I(e,{nodeType:r.nodeType})})}dispatchTransaction(e){let r=this.editorView.state.apply(e),o=r.doc.toJSON(),n=document.querySelector(this.target);n.value=JSON.stringify(o),n.dispatchEvent(new CustomEvent("change",{detail:JSON.parse(n.value)})),this.editorView.updateState(r)}};var{exampleSetup:ae}=a("prosemirror-example-setup"),J={};J.MountProseMirror={mounted(){O.init(this.el,{schemaFunc:p,pluginFunc:ae})},updated(){O.init(this.el,{schemaFunc:p,pluginFunc:ae})}};var{keymap:ie}=a("prosemirror-keymap"),{baseKeymap:se,chainCommands:_e,exitCode:De}=a("prosemirror-commands");function Ce(t,e){let r=t.schema.nodes.hard_break;e(t.tr.replaceSelectionWith(r.create()).scrollIntoView())}var le={"Shift-Enter":_e(De,Ce)};var Ve=document.querySelectorAll(".ex-prosemirror"),ce=class{setBlocks(e){return this.blocks=e,this}setMarks(e){return this.marks=e,this}setPlugins(e){return this.plugins=e,this}initAll(){Array.from(Ve).forEach(e=>{this.init(e)})}init(e){if(e instanceof HTMLElement){e.innerHTML="";let r=this.plugins||[];return new h(e,{blocks:this.blocks,marks:this.marks,plugins:r})}return null}},O=new ce;return Ae;})();
